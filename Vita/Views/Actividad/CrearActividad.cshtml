
@{
    ViewBag.Title = "CrearActividad";
    Layout = "~/Views/Shared/_LayoutPerfilEntidad.cshtml";
}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">

</head>

<body>
    <div class="container-fluid">
        <div class="row justify-content-center">
            <div class="col-lg-12">
                <div class="card">
                    <div class="card-body">

                        <h3>Crear actividad</h3>
                        <div class="form-validation">
                            <form class="form-valide" action="CreacionActividad" method="POST">
                                <div class="form-group row">
                                    <label class="col-lg-4 col-form-label" for="Titulo">
                                        Título de la actividad<span class="text-danger">*</span>
                                    </label>
                                    <div class="col-lg-6">
                                        <input type="text" class="form-control" id="val-username" name="Titulo" placeholder="Truco..">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-lg-4 col-form-label" for="Descripcion">
                                        Breve descripción <span class="text-danger">*</span>
                                    </label>
                                    <div class="col-lg-6">
                                        <textarea class="form-control" id="val-suggestions" name="Descripcion" rows="5" placeholder="Torneo de truco con premios..."></textarea>
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-lg-4 col-form-label" for="val-skill">
                                        Segmento <span class="text-danger">*</span>
                                    </label>
                                    <div class="col-lg-6">
                                        <div class="form-control">
                                            @foreach (var item in ViewBag.ListaSegmentos)
                                            {
                                                <input type="checkbox" name="selectedSegmento" value="@item.Value" />
                                                @item.Text
                                            }
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-lg-4 col-form-label" for="val-skill">
                                        Rubro <span class="text-danger">*</span>
                                    </label>
                                    <div class="col-lg-6" id="filtroSubcategoria" name="CategoriaId">
                                        @*<select class="form-control" id="filtroCategoria"
                                                data-live-search="true" title="Seleccione tipo de categoria de la actividad.." name="CategoriaId">
                                            @foreach (var item in ViewBag.ListaRubro as MultiSelectList)
                                            {
                                                <option value="@item.Value">@item.Text</option>
                                            }
                                        </select>*@
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-lg-4 col-form-label" for="SubCategoriaId">
                                        Tipo de actividad <span class="text-danger">*</span>
                                    </label>
                                    <div class="col-lg-6">
                                        <select class="form-control" id="SubCategoriaId" onchange="changeOption(this)"
                                                data-live-search="true" title="Seleccione tipo de actividad.." name="SubCategoriaId">
                                            @foreach (var item in ViewBag.ListaTipoActividad as MultiSelectList)
                                            {
                                                <option value="@item.Value">@item.Text</option>
                                            }
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-lg-4 col-form-label" for="SubCategoriaId">
                                        Seleccione Localidad <span class="text-danger">*</span>
                                    </label>
                                    <div class="col-lg-6">
                                        <select class="form-control" id="LocalidadId" onchange="changeOption(this)"
                                                data-live-search="true" title="Seleccione localidad.." name="LocalidadId">
                                            @foreach (var item in ViewBag.ListaLocalidades as MultiSelectList)
                                            {
                                                <option value="@item.Value">@item.Text</option>
                                            }
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-lg-4 col-form-label" for="CantidadDias">
                                        Cantidad de dias que va a estar la actividad<span class="text-danger">*</span>
                                    </label>
                                    <div class="col-lg-6">
                                        <input type="text" class="form-control" id="val-number" name="CantidadDias" placeholder="5">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <!--Fecha de nacimiento-->
                                    <label class="label">Desde que fecha esta disponible la actividad</label>
                                    <div class="input-group-icon">
                                        <input class="input--style-4 js-datepicker" type="text" name="FechaNacimiento">
                                        <i class="zmdi zmdi-calendar-note input-icon js-btn-calendar"></i>
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <!--Fecha de nacimiento-->
                                    <label class="label">Fecha en la que se termina la actividad</label>
                                    <div class="input-group-icon">
                                        <input class="input--style-4 js-datepicker" type="text" name="FechaNacimiento">
                                        <i class="zmdi zmdi-calendar-note input-icon js-btn-calendar"></i>
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-lg-4 col-form-label" for="CantidadCupo">
                                        Cantidad de cupos disponibles<span class="text-danger">*</span>
                                    </label>
                                    <div class="col-lg-6">
                                        <input type="text" class="form-control" id="val-number" name="CantidadCupo" placeholder="100">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-lg-4 col-form-label" for="EdadMinima">
                                        Edad mínima<span class="text-danger">*</span>
                                    </label>
                                    <div class="col-lg-6">
                                        <input type="text" class="form-control" id="val-number" name="EdadMinima" placeholder="25">
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label class="col-lg-4 col-form-label" for="EdadMaxima">
                                        Edad máxima<span class="text-danger">*</span>
                                    </label>
                                    <div class="col-lg-6">
                                        <input type="text" class="form-control" id="val-number" name="EdadMaxima" placeholder="70">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-lg-4 col-form-label" for="Precio">
                                        Precio (en caso de no tener, poner cero en número) <span class="text-danger">*</span>
                                    </label>
                                    <div class="col-lg-6">
                                        <input type="text" class="form-control" id="val-currency" name="Precio" placeholder="21.60">
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <div class="col-lg-8 ml-auto">
                                        <button type="submit" class="btn btn-primary">Crear Actividad</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="plugins/common/common.min.js"></script>
    <script src="js/custom.min.js"></script>
    <script src="js/settings.js"></script>
    <script src="js/gleek.js"></script>
    <script src="js/styleSwitcher.js"></script>
    <script src="./plugins/validation/jquery.validate.min.js"></script>
    <script src="./plugins/validation/jquery.validate-init.js"></script>
    <script src="./vendor/datepicker/moment.min.js"></script>
    <script src="./vendor/datepicker/daterangepicker.js"></script>
</body>

</html>
<script>
 //Todo siempre una vez cargada la página
        $(document).ready(function () {

            //Esto corre cuando cambias de opción en el primer select
            $('#filtroCategoria').on('change', function () {

               var idCategoria = $(this).val();

                //Si elegiste la opción de los guíones paramos aca para no hacer nada
                if (idCategoria === 0) {
                    $("#filtroSubcategoria").html("Selecciona una categoria");
                    return;
                }

                //Ajax
                $.ajax({
                   url: "obtenersubcategoria/" + idCategoria,

                    type: 'GET',
                    dataType: "json",
                    success: function (res) {
                        //Por si queres ver una por una las cosas que vuelven descomenta el alert
                        alert(res);

                        //Creando el segundo select
                        $("#filtroSubcategoria").empty().append('<select id="filtroeligecategoria" class="selectpicker">');
                        $.getJSON("@Url.Action("ObtenerSubcategoria","Actividad")", { idCategoria: idCategoria }, function (data) {
                              let data2 = JSON.parse(data);
                             $.each(data2, function () {
                                 $("#filtroeligecategoria").append($("<option>").val(this.Id).text(this.Descripcion));
                                  });
                             });
                    }
                });
            });
        });
</script>

